<!DOCTYPE html>
<html lang="en-us">
    
    


    <head>
    <link href="https://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Cache-Control" content="public" />
<!-- Enable responsiveness on mobile devices -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.70.0" />

    
    
    

<title>Playing Custom Haptics on iOS • Andy Ibanez</title>


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Playing Custom Haptics on iOS"/>
<meta name="twitter:description" content="Learn to use the different NSFormatter subclasses to format data in a human-readable way."/>

<meta property="og:title" content="Playing Custom Haptics on iOS" />
<meta property="og:description" content="Learn to use the different NSFormatter subclasses to format data in a human-readable way." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.andyibanez.com/posts/playing-custom-haptics-on-ios/" />
<meta property="article:published_time" content="2019-10-02T07:00:00-04:00" />
<meta property="article:modified_time" content="2019-10-02T07:00:00-04:00" /><meta property="og:site_name" content="Andy Ibanez - iOS Developer" />


    


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">








<link rel="stylesheet" href="/scss/hyde-hyde.e4368406c047b72036bd31fdf69f74f805156724914c166a0accb2369a218b61.css" integrity="sha256-5DaEBsBHtyA2vTH99p90&#43;AUVZySRTBZqCsyyNpohi2E=">


<link rel="stylesheet" href="/scss/print.2744dcbf8a0b2e74f8a50e4b34e5f441be7cf93cc7de27029121c6a09f9e77bc.css" integrity="sha256-J0Tcv4oLLnT4pQ5LNOX0Qb58&#43;TzH3icCkSHGoJ&#43;ed7w=" media="print">



    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="/favicon.png">
    <script data-ad-client="ca-pub-3640551804216350" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-146179797-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

</head>


    <body class=" ">
    
<div class="sidebar">
  <div class="container ">
    <div class="sidebar-about">
      <span class="site__title">
        <a href="https://www.andyibanez.com">Andy Ibanez</a>
      </span>
      
      
        <div class="author-image">
          <img src="https://www.gravatar.com/avatar/196dd48d2ac425661edf58028d499370?s=240&d=mp" class="img--circle img--headshot element--center" alt="gravatar">
        </div>
      
      <p class="site__description">
         Software Developer from La Paz, Bolivia. Programming for iOS since 2011. 
      </p>
    </div>
    <div class="collapsible-menu">
      <input type="checkbox" id="menuToggle">
      <label for="menuToggle">Andy Ibanez</label>
      <div class="menu-content">
        <div>
	<ul class="sidebar-nav">
		 
		 
			 
				<li>
					<a href="/posts/">
						<span>Posts</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/tags/wwdc2020/">
						<span>WWDC 2020</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/projects/">
						<span>Projects</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/about/">
						<span>About Me</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/privacy-policy/">
						<span>Privacy Policy</span>
					</a>
				</li>
			 
		
	</ul>
</div>

        <section class="social">
	
	<a href="https://twitter.com/AndyIbanezK" rel="me"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a>
	
	
	<a href="https://facebook.com/AndyIbanezCom" rel="me"><i class="fab fa-facebook-f"></i></a>
	
	
	<a href="https://github.com/andyibanez" rel="me"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	<a href="https://instagram.com/andyibanez" rel="me"><i class="fab fa-instagram fa-lg" aria-hidden="true"></i></a>
	
	
	<a href="https://linkedin.com/in/andr%c3%a9s-iba%c3%b1ez-30234033" rel="me"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a>
	
	
	<a href="https://stackoverflow.com/users/648767" rel="me"><i class="fab fa-stack-overflow fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	<a href="https://keybase.io/andyibanez" rel="me"><i class="fab fa-keybase fa-lg" aria-hidden="true"></i></a>
	
	
	
	
</section>

      </div>
    </div>
    
<div class="copyright">
  &copy; 2021 Andrés Ibañez
  
</div>



  </div>
</div>

        <div class="content container">
            
    
<article>
  <header>
    <h1>Playing Custom Haptics on iOS</h1>
    
    
<div class="post__meta">
    
    
      <i class="fas fa-calendar-alt"></i> Oct 2, 2019
    
    
    
      
      
          in
          
          
              <a class="badge badge-category" href="/categories/development">DEVELOPMENT</a>
              
          
      
    
    
    
      
      
          <br/>
           <i class="fas fa-tags"></i>
          
          <a class="badge badge-tag" href="/tags/swift">swift</a>
           
      
          <a class="badge badge-tag" href="/tags/programming">programming</a>
           
      
          <a class="badge badge-tag" href="/tags/apple">apple</a>
           
      
          <a class="badge badge-tag" href="/tags/ios">ios</a>
           
      
          <a class="badge badge-tag" href="/tags/macos">macos</a>
           
      
          <a class="badge badge-tag" href="/tags/watchos">watchos</a>
           
      
          <a class="badge badge-tag" href="/tags/corehaptics">corehaptics</a>
           
      
          <a class="badge badge-tag" href="/tags/ios13">ios13</a>
           
      
          <a class="badge badge-tag" href="/tags/wwdc2019">wwdc2019</a>
          
      
    
    
    <br/>
    <i class="fas fa-clock"></i> 6 min read
</div>


  </header>
  
  
  <div class="post">
    <p>Vibration and physical feedback has become an important feature of Apple&rsquo;s operating systems. Starting with the Apple Watch, Apple replaced the traditional vibration feedback with haptic feedback hardware, which allowed them to have more control over how vibrations and physical feedback work.</p>
<p>First being introduced in the Apple Watch, Haptic Feedback has been a core part of the Apple ecosystem experience since. Just think about it, wouldn&rsquo;t it be weird if you force-touched the screen to do something, and there was no physical response from the device? Think of the old Peek-and-Pop. If you updated to iOS 13 and got context menus, you may feel they feel great to do in iOS (because they have a haptic engine), but on iPad they feel lacking because the device doesn&rsquo;t vibrate when triggering them.</p>
<p>Haptic feedback is present even in the most unexpected places of Apple&rsquo;s lineup. Their touch-pads respond with haptics. The iPhone 7 and 8, which have no physical home button, create exactly the same feeling by providing a haptic instead of physical touch presses. We may not notice it, but if you are deep into Apple&rsquo;s ecosystem, haptics are all over the place.</p>
<p>In this article, we will explore how we can integrate haptic feedback into our iOS 13 apps.</p>
<h1 id="playing-with-haptic-feedback-on-ios-13">Playing with Haptic Feedback on iOS 13.</h1>
<p>Apple has a few APIs that give developers a lot of control over the haptics they want to create on iOS 13.</p>
<p>The <a href="https://developer.apple.com/documentation/corehaptics/chhapticengine">CHHapticEngine</a> handles requests to play haptic patterns.</p>
<p>To use it, you need to <code>import CoreHaptics</code>.</p>
<h2 id="corehaptics-setup">CoreHaptics Setup</h2>
<p>Before you actually try to play some feedbacks, though you need to ensure that the device supports them. As we discussed earlier, not all devices support them, and a notable example of that are all iPads released until now.</p>
<p>To check if your device supports haptics, the <code>CHHapticEngine</code> object has a static method called <code>capabilitiesForHardware()</code> that returns the supported feedback capabilities.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#66d9ef">guard</span> CHHapticEngine.capabilitiesForHardware().supportsHaptics <span style="color:#66d9ef">else</span> {
	<span style="color:#75715e">// Haptics not supported.</span>
	<span style="color:#66d9ef">return</span>
}
</code></pre></div><p>Once you know your device supports haptics, you can create one like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#66d9ef">var</span> engine: CHHapticEngine?
<span style="color:#75715e">// ...</span>
<span style="color:#66d9ef">do</span>
{
  engine = <span style="color:#66d9ef">try</span> CHHapticEngine()
  <span style="color:#66d9ef">try</span> engine?.start()
} <span style="color:#66d9ef">catch</span> {
  print(<span style="color:#e6db74">&#34;Problem with haptics: </span><span style="color:#e6db74">\(</span>error<span style="color:#e6db74">)</span><span style="color:#e6db74">&#34;</span>)
}
</code></pre></div><p>It&rsquo;s not clear to me at this when the engine can throw an error as there&rsquo;s a tremendous lack of documentation at this time, even after iOS 13 has been released. My assumption is when you try using it in a device that doesn&rsquo;t have a haptic engine, or when the hardware inside the device is malfunctioning.</p>
<p>The feedback engine is the connection to the haptic server inside a device. You can create multiple connections to this server (via multiple instances of <code>CHHapticEngine</code>), so don&rsquo;t worry about treating it as a singleton. Each connection is independent of the others.</p>
<p>The call to <code>start()</code> is asynchronous, so be wary of that. There is an asynchronous variation that takes a completion clock if you need it:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift">  engine?.start(completionHandler: { (error) <span style="color:#66d9ef">in</span>
    <span style="color:#75715e">// .. Handle error if relevant</span>
    <span style="color:#75715e">// .. Do something after it starts</span>
  })
</code></pre></div><p>There&rsquo;s some additional properties you can set. If the Haptic Engine gets stopped for any reason, you an get a callback. When there&rsquo;s an error with the haptic server, you can also get notified when it has been reset.</p>
<p>Below are the two relevant properties:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift">engine?.stoppedHandler = { reason <span style="color:#66d9ef">in</span>
  print(<span style="color:#e6db74">&#34;Haptic engine stopped due to reason: </span><span style="color:#e6db74">\(</span>reason<span style="color:#e6db74">)</span><span style="color:#e6db74">&#34;</span>)
}
          
engine?.resetHandler = {
		<span style="color:#75715e">// The engine has been reset, so you can try connecting to it again.</span>
    <span style="color:#66d9ef">do</span> {
      <span style="color:#66d9ef">try</span> engine?.start()
    } <span style="color:#66d9ef">catch</span> {
      <span style="color:#75715e">// handle error.</span>
    }
}
</code></pre></div><h2 id="playing-haptic-events">Playing Haptic Events</h2>
<p>After you have done all that setup, you can start creating some haptics events. You create an event, request a player from the server, and send your haptic requests to that player.</p>
<p>To create a haptic event, you begin creating the parameters that will be used to configure it.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#66d9ef">let</span> intensity = CHHapticEventParameter(parameterID: .hapticSharpness, value: <span style="color:#ae81ff">0.5</span>) <span style="color:#75715e">// The feel of  haptic event, from dull to sharp</span>
<span style="color:#66d9ef">let</span> sharpness = CHHapticEventParameter(parameterID: .hapticIntensity, value: <span style="color:#ae81ff">0.5</span>) <span style="color:#75715e">// How strong the haptic is</span>
<span style="color:#75715e">// Some advanced parameters</span>
<span style="color:#66d9ef">let</span> attackTime = CHHapticEventParameter(parameterID: .attackTime, value: <span style="color:#ae81ff">0.5</span>) <span style="color:#75715e">// When to increase the intensity of the haptic.</span>
<span style="color:#66d9ef">let</span> decayTime = CHHapticEventParameter(parameterID: .decayTime, value: <span style="color:#ae81ff">0.5</span>) <span style="color:#75715e">// When the intensity of the haptic goes down.</span>
<span style="color:#66d9ef">let</span> releaseTime = CHHapticEventParameter(parameterID: .releaseTime, value: <span style="color:#ae81ff">0.5</span>) <span style="color:#75715e">// If you want the haptic to &#34;fade&#34;, when</span>
<span style="color:#66d9ef">let</span> sustainTime = CHHapticEventParameter(parameterID: .sustained, value: <span style="color:#66d9ef">true</span>) <span style="color:#75715e">// If you want to sustain the haptic for its entire duration.</span>

<span style="color:#66d9ef">let</span> event = CHHapticEvent(eventType: .hapticTransient, parameters: [intensity, sharpness], relativeTime: <span style="color:#ae81ff">0</span>)

<span style="color:#66d9ef">do</span> {
    <span style="color:#66d9ef">let</span> pattern = <span style="color:#66d9ef">try</span> CHHapticPattern(events: [event], parameters: [])
    <span style="color:#66d9ef">let</span> player = <span style="color:#66d9ef">try</span> engine?.makePlayer(with: pattern)
    <span style="color:#66d9ef">try</span> player?.start(atTime: <span style="color:#ae81ff">0</span>)
} <span style="color:#66d9ef">catch</span> {
    print(<span style="color:#e6db74">&#34;Failed perform haptic: </span><span style="color:#e6db74">\(</span>error.localizedDescription<span style="color:#e6db74">)</span><span style="color:#e6db74">.&#34;</span>)
}
</code></pre></div><p>The <code>eventType</code> can be <code>hapticTransient</code> or <code>hapticContinous</code>. The former is to play simple &ldquo;tics&rdquo;. Think of the haptic you get when flipping a UISwitch, or exploring the options in a UIPicker. The latter is to give more lasting feedback, such as a longer vibration when an error occurs in a textfield. This is interesting to use in games because you can create haptics that resemble the situation in the game. If you get hit, you get a light vibration, but as you keep getting and your life bar depletes, you can make it more and more intense.</p>
<p>These are just some of the basic configurations you can do for your feedbacks. Alongside vibrations, you can play sound as part of an event so you can create feedback similar to that of the context menus in Springboard. You can even read and write haptics into a file so users can create their own. In the Settings app on iPhone, you can create custom vibration patterns for calls, and they all use haptic feedbacks.</p>
<p>Audio haptics come with their own set of parameters as well, including the frequency (brightness), audio volume, audio pan, and pitch. If you have a designer who wants to experiment with these, it could be fun to play with them.</p>
<h1 id="conclusion">Conclusion</h1>
<p>Using Haptics on Apple&rsquo;s devices is now easier than ever and we have a lot of flexibility to implement them. When designing apps, consider the interactions where you could use haptics to improve the experience of your users, but be careful not to overdo them because if used wrongly, they can cause physical discomfort. Try to see where devices that support use it so you can learn the best place to implement it.</p>

  </div>
  

<div class="navigation navigation-single">
    
    <a href="/posts/nsformatter/" class="navigation-prev">
      <i aria-hidden="true" class="fa fa-chevron-left"></i>
      <span class="navigation-tittle">Formatting Content with NSFormatter</span>
    </a>
    
    
    <a href="/posts/common-cryptographic-operations-with-cryptokit/" class="navigation-next">
      <span class="navigation-tittle">Common Cryptographic Operations With CryptoKit</span>
      <i aria-hidden="true" class="fa fa-chevron-right"></i>
    </a>
    
</div>


  

  
    
        <script src="https://utteranc.es/client.js"
        repo="AndyIbanez/andyibanez-com"
        issue-term="pathname"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
    


</article>


        </div>
        
    

  
  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-146179797-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


<script defer src="https://use.fontawesome.com/releases/v5.5.0/js/all.js" integrity="sha384-GqVMZRt5Gn7tB9D9q7ONtcp4gtHIUEW/yG7h98J7IpE3kpi+srfFyyB/04OV6pG0" crossorigin="anonymous"></script>


    
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
        
            
                <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/languages/swift.min.js"></script>
            
                <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/languages/objectivec.min.js"></script>
            
        
    
    <script type="text/javascript">
        
        hljs.configure({languages: ["swift, objectivec"]});
        
        hljs.initHighlightingOnLoad();
    </script>
    




    



    </body>
</html>
