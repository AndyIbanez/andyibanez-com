<!DOCTYPE html>
<html lang="en-us">
    
    


    <head>
    <link href="https://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Cache-Control" content="public" />
<!-- Enable responsiveness on mobile devices -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.70.0" />

    
    
    

<title>Tokenizing Natural Language into Semantic Units in iOS • Andy Ibanez</title>


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Tokenizing Natural Language into Semantic Units in iOS"/>
<meta name="twitter:description" content="Learn how to use the NLTokenizer Class to separate natural language strings into components."/>

<meta property="og:title" content="Tokenizing Natural Language into Semantic Units in iOS" />
<meta property="og:description" content="Learn how to use the NLTokenizer Class to separate natural language strings into components." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.andyibanez.com/posts/tokenizing-nltokenizer/" />
<meta property="article:published_time" content="2020-02-12T07:00:00-04:00" />
<meta property="article:modified_time" content="2020-02-12T07:00:00-04:00" /><meta property="og:site_name" content="Andy Ibanez - iOS Developer" />


    


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">








<link rel="stylesheet" href="/scss/hyde-hyde.e4368406c047b72036bd31fdf69f74f805156724914c166a0accb2369a218b61.css" integrity="sha256-5DaEBsBHtyA2vTH99p90&#43;AUVZySRTBZqCsyyNpohi2E=">


<link rel="stylesheet" href="/scss/print.2744dcbf8a0b2e74f8a50e4b34e5f441be7cf93cc7de27029121c6a09f9e77bc.css" integrity="sha256-J0Tcv4oLLnT4pQ5LNOX0Qb58&#43;TzH3icCkSHGoJ&#43;ed7w=" media="print">



    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="/favicon.png">
    <script data-ad-client="ca-pub-3640551804216350" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-146179797-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

</head>


    <body class=" ">
    
<div class="sidebar">
  <div class="container ">
    <div class="sidebar-about">
      <span class="site__title">
        <a href="https://www.andyibanez.com">Andy Ibanez</a>
      </span>
      
      
        <div class="author-image">
          <img src="https://www.gravatar.com/avatar/196dd48d2ac425661edf58028d499370?s=240&d=mp" class="img--circle img--headshot element--center" alt="gravatar">
        </div>
      
      <p class="site__description">
         Software Developer from La Paz, Bolivia. Programming for iOS since 2011. 
      </p>
    </div>
    <div class="collapsible-menu">
      <input type="checkbox" id="menuToggle">
      <label for="menuToggle">Andy Ibanez</label>
      <div class="menu-content">
        <div>
	<ul class="sidebar-nav">
		 
		 
			 
				<li>
					<a href="/posts/">
						<span>Posts</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/tags/wwdc2020/">
						<span>WWDC 2020</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/projects/">
						<span>Projects</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/about/">
						<span>About Me</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/privacy-policy/">
						<span>Privacy Policy</span>
					</a>
				</li>
			 
		
	</ul>
</div>

        <section class="social">
	
	<a href="https://twitter.com/AndyIbanezK" rel="me"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a>
	
	
	<a href="https://facebook.com/AndyIbanezCom" rel="me"><i class="fab fa-facebook-f"></i></a>
	
	
	<a href="https://github.com/andyibanez" rel="me"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	<a href="https://instagram.com/andyibanez" rel="me"><i class="fab fa-instagram fa-lg" aria-hidden="true"></i></a>
	
	
	<a href="https://linkedin.com/in/andr%c3%a9s-iba%c3%b1ez-30234033" rel="me"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a>
	
	
	<a href="https://stackoverflow.com/users/648767" rel="me"><i class="fab fa-stack-overflow fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	<a href="https://keybase.io/andyibanez" rel="me"><i class="fab fa-keybase fa-lg" aria-hidden="true"></i></a>
	
	
	
	
</section>

      </div>
    </div>
    
<div class="copyright">
  &copy; 2021 Andrés Ibañez
  
</div>



  </div>
</div>

        <div class="content container">
            
    
<article>
  <header>
    <h1>Tokenizing Natural Language into Semantic Units in iOS</h1>
    
    
<div class="post__meta">
    
    
      <i class="fas fa-calendar-alt"></i> Feb 12, 2020
    
    
    
      
      
          in
          
          
              <a class="badge badge-category" href="/categories/development">DEVELOPMENT</a>
              
          
      
    
    
    
      
      
          <br/>
           <i class="fas fa-tags"></i>
          
          <a class="badge badge-tag" href="/tags/swift">swift</a>
           
      
          <a class="badge badge-tag" href="/tags/programming">programming</a>
           
      
          <a class="badge badge-tag" href="/tags/apple">apple</a>
           
      
          <a class="badge badge-tag" href="/tags/ios">ios</a>
           
      
          <a class="badge badge-tag" href="/tags/ipados">ipados</a>
           
      
          <a class="badge badge-tag" href="/tags/tvos">tvos</a>
           
      
          <a class="badge badge-tag" href="/tags/watchos">watchos</a>
           
      
          <a class="badge badge-tag" href="/tags/macos">macos</a>
           
      
          <a class="badge badge-tag" href="/tags/natural-language">natural language</a>
          
      
    
    
    <br/>
    <i class="fas fa-clock"></i> 4 min read
</div>


  </header>
  
  
  <div class="post">
    <p>Working with Natural Language is possible thanks to machine learning. Starting on iOS 12, Apple has provided many APIs just for this task. In this article we will explore how to use <a href="https://developer.apple.com/documentation/naturallanguage/nltokenizer"><code>NLTokenizer</code></a> to separate natural language text into its proper units.</p>
<h1 id="introduction-to-natural-language-tokenizing">Introduction to Natural Language Tokenizing</h1>
<p>If you are not familiar with the inner workings of Natural Language processing, tokenizing simply means that we separate a string and analyze it to find its semantic units. If you are writing a program that processes text, you may be tempted to split the string using a separator. For example, if you wanted to get all the words in a natural sentence string in an array, you would write something like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#e6db74">&#34;This should be separated into words using the space&#34;</span>.split(separator: <span style="color:#e6db74">&#34; &#34;</span>)
</code></pre></div><p>And this naive approach <em>may</em> work under very specific constraints. Specifically, you know it will work if the language you are using is English. But languages such as Japanese don&rsquo;t separate their sentences with spaces. So what do you do if you need to support different languages? This is where the tokenizer comes into play.</p>
<h1 id="using-nltokenizer">Using NLTokenizer</h1>
<p>Start by importing the <code>NaturalLanguage</code> framework.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Swift" data-lang="Swift"><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">NaturalLanguage</span>
</code></pre></div><p>To create the <code>NLTokenizer</code> object, call the <code>NLTokenizer(using:)</code> method, to which you have to specify what <code>NLTokenUnit</code> you want to use. At the time of this writing, you can use <code>.document</code>, <code>.paragraph</code>, <code>.sentence</code>, <code>.word</code>. The unit allows you to specify the linguistic unit. If you choose <code>.word</code>, the tokenizer will take every word and give it back to you. As you use the other units, you will get bigger portions of text.</p>
<p>In the example below, we will tokenize a simple sentence.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#66d9ef">var</span> stringToTokenize = <span style="color:#e6db74">&#34;It was many and many a year ago, in a kingdom by the sea.&#34;</span>

<span style="color:#66d9ef">let</span> tokenizer = NLTokenizer(unit: .sentence)
tokenizer.string = stringToTokenize
</code></pre></div><p>Since we have a single sentence, we will use the <code>.sentence</code> unit, and the first phrase of my favorite poem (<a href="https://en.wikipedia.org/wiki/Annabel_Lee">Annabel Lee</a>, by Edgar Allan Poe).</p>
<p>It&rsquo;s worth noting that you can specify the language to use. By default the system will use your default language, but you can specify a different language. To be more explicitly, I will set the language to English.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift">tokenizer.setLanguage(.english)
</code></pre></div><p>And we can finally go through the words:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift">tokenizer.enumerateTokens(<span style="color:#66d9ef">in</span>: fullStringRange) { (range, attributes) -&gt; Bool <span style="color:#66d9ef">in</span>
  print(stringToTokenize[range])
  <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>
}
</code></pre></div><p>The return indicates the enumerator if it should continue going through each token. If you return false, the enumerator will stop.</p>
<p>The output for the above code is the following:</p>
<pre><code>It
was
many
and
many
a
year
ago
in
a
kingdom
by
the
sea
</code></pre><h2 id="tokenizing-different-languages">Tokenizing Different Languages</h2>
<p>Some languages don&rsquo;t separate words in a sentence the same way, so it can be expected that they may also separate other words with different symbols. We will now tokenize a Japanese string into words.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#66d9ef">var</span> stringToTokenize = <span style="color:#e6db74">&#34;私は毎日太っています&#34;</span>

<span style="color:#66d9ef">let</span> tokenizer = NLTokenizer(unit: .word)
tokenizer.string = stringToTokenize
tokenizer.setLanguage(.japanese)
<span style="color:#66d9ef">let</span> fullStringRange = stringToTokenize.startIndex..&lt;stringToTokenize.endIndex

tokenizer.enumerateTokens(<span style="color:#66d9ef">in</span>: fullStringRange) { (range, attributes) -&gt; Bool <span style="color:#66d9ef">in</span>
  print(stringToTokenize[range])
  <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>
}
</code></pre></div><p>Output:</p>
<pre><code>私
は
毎日
太っ
て
い
ます
</code></pre><p>So, even if Japanese is a &ldquo;run-on&rdquo; written language, where there&rsquo;s no visual way to separate words from each other, the tokenizer knows where each word begins and ends.</p>
<!-- raw HTML omitted -->
<p>If any point you have troubles with the tokenizer, and the enumeration function doesn&rsquo;t give you anything, try setting the language <em>before</em> the string. For some reason, at least with the <code>NSLanguage</code> being <code>.spanish</code>, I had to set the language first.</p>
<!-- raw HTML omitted -->
<h1 id="conclusion">Conclusion</h1>
<p>Separating a string with a token is a common task, but doing it naively will not account for all possible cases. <code>NLTokenizer</code> is very smart as it can process words in many languages and already knows about a lot of special cases. If you are tokenizing strings in natural language, you should use this class instead of trying to do it manually.</p>

    <hr>

  <p>If you find any inaccuracies (and that includes typos) or problems in this article please tweet at me (<a href="https://twitter.com/AndyIbanezK" target="_blank">@AndyIbanezK</a>) or send me an e-mail to website[at]andyibanez[dot]com.</p>

  <p>Please do not e-mail to ask me to cross-promote your website or any other soliciting of that kind. AndyIbanez.com is a personal blog, and unless there's a chance to enter a sponsorship relationship with you, I may ignore your message.</p>

  <p>Thank you for helping me improve the quality of my blog!</p>
  </div>
  

<div class="navigation navigation-single">
    
    <a href="/posts/matching-nl-nsdatadetector/" class="navigation-prev">
      <i aria-hidden="true" class="fa fa-chevron-left"></i>
      <span class="navigation-tittle">Matching Natural Language Text for Predefined Data Patterns on Apple&#39;s Devices</span>
    </a>
    
    
    <a href="/posts/recognizing-language-nllanguagerecognizer/" class="navigation-next">
      <span class="navigation-tittle">Recognizing the language in a Natural Language Text with NLanguageRecognizer</span>
      <i aria-hidden="true" class="fa fa-chevron-right"></i>
    </a>
    
</div>


  

  
    
        <script src="https://utteranc.es/client.js"
        repo="AndyIbanez/andyibanez-com"
        issue-term="pathname"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
    


</article>


        </div>
        
    

  
  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-146179797-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


<script defer src="https://use.fontawesome.com/releases/v5.5.0/js/all.js" integrity="sha384-GqVMZRt5Gn7tB9D9q7ONtcp4gtHIUEW/yG7h98J7IpE3kpi+srfFyyB/04OV6pG0" crossorigin="anonymous"></script>


    
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
        
            
                <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/languages/swift.min.js"></script>
            
                <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/languages/objectivec.min.js"></script>
            
        
    
    <script type="text/javascript">
        
        hljs.configure({languages: ["swift, objectivec"]});
        
        hljs.initHighlightingOnLoad();
    </script>
    




    



    </body>
</html>
