<!DOCTYPE html>
<html lang="en-us">
    
    


    <head>
    <link href="https://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Cache-Control" content="public" />
<!-- Enable responsiveness on mobile devices -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.70.0" />

    
    
    

<title>Formatting Content with NSFormatter • Andy Ibanez</title>


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Formatting Content with NSFormatter"/>
<meta name="twitter:description" content="Learn to use the different NSFormatter subclasses to format data in a human-readable way."/>

<meta property="og:title" content="Formatting Content with NSFormatter" />
<meta property="og:description" content="Learn to use the different NSFormatter subclasses to format data in a human-readable way." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.andyibanez.com/posts/nsformatter/" />
<meta property="article:published_time" content="2019-09-25T07:00:00-04:00" />
<meta property="article:modified_time" content="2019-09-25T07:00:00-04:00" /><meta property="og:site_name" content="Andy Ibanez - iOS Developer" />


    


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">








<link rel="stylesheet" href="/scss/hyde-hyde.e4368406c047b72036bd31fdf69f74f805156724914c166a0accb2369a218b61.css" integrity="sha256-5DaEBsBHtyA2vTH99p90&#43;AUVZySRTBZqCsyyNpohi2E=">


<link rel="stylesheet" href="/scss/print.2744dcbf8a0b2e74f8a50e4b34e5f441be7cf93cc7de27029121c6a09f9e77bc.css" integrity="sha256-J0Tcv4oLLnT4pQ5LNOX0Qb58&#43;TzH3icCkSHGoJ&#43;ed7w=" media="print">



    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="/favicon.png">
    <script data-ad-client="ca-pub-3640551804216350" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-146179797-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

</head>


    <body class=" ">
    
<div class="sidebar">
  <div class="container ">
    <div class="sidebar-about">
      <span class="site__title">
        <a href="https://www.andyibanez.com">Andy Ibanez</a>
      </span>
      
      
        <div class="author-image">
          <img src="https://www.gravatar.com/avatar/196dd48d2ac425661edf58028d499370?s=240&d=mp" class="img--circle img--headshot element--center" alt="gravatar">
        </div>
      
      <p class="site__description">
         Software Developer from La Paz, Bolivia. Programming for iOS since 2011. 
      </p>
    </div>
    <div class="collapsible-menu">
      <input type="checkbox" id="menuToggle">
      <label for="menuToggle">Andy Ibanez</label>
      <div class="menu-content">
        <div>
	<ul class="sidebar-nav">
		 
		 
			 
				<li>
					<a href="/posts/">
						<span>Posts</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/tags/wwdc2020/">
						<span>WWDC 2020</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/projects/">
						<span>Projects</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/about/">
						<span>About Me</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/privacy-policy/">
						<span>Privacy Policy</span>
					</a>
				</li>
			 
		
	</ul>
</div>

        <section class="social">
	
	<a href="https://twitter.com/AndyIbanezK" rel="me"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a>
	
	
	<a href="https://facebook.com/AndyIbanezCom" rel="me"><i class="fab fa-facebook-f"></i></a>
	
	
	<a href="https://github.com/andyibanez" rel="me"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	<a href="https://instagram.com/andyibanez" rel="me"><i class="fab fa-instagram fa-lg" aria-hidden="true"></i></a>
	
	
	<a href="https://linkedin.com/in/andr%c3%a9s-iba%c3%b1ez-30234033" rel="me"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a>
	
	
	<a href="https://stackoverflow.com/users/648767" rel="me"><i class="fab fa-stack-overflow fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	<a href="https://keybase.io/andyibanez" rel="me"><i class="fab fa-keybase fa-lg" aria-hidden="true"></i></a>
	
	
	
	
</section>

      </div>
    </div>
    
<div class="copyright">
  &copy; 2021 Andrés Ibañez
  
</div>



  </div>
</div>

        <div class="content container">
            
    
<article>
  <header>
    <h1>Formatting Content with NSFormatter</h1>
    
    
<div class="post__meta">
    
    
      <i class="fas fa-calendar-alt"></i> Sep 25, 2019
    
    
    
      
      
          in
          
          
              <a class="badge badge-category" href="/categories/development">DEVELOPMENT</a>
              
          
      
    
    
    
      
      
          <br/>
           <i class="fas fa-tags"></i>
          
          <a class="badge badge-tag" href="/tags/swift">swift</a>
           
      
          <a class="badge badge-tag" href="/tags/programming">programming</a>
           
      
          <a class="badge badge-tag" href="/tags/apple">apple</a>
           
      
          <a class="badge badge-tag" href="/tags/ios">ios</a>
           
      
          <a class="badge badge-tag" href="/tags/ipados">ipados</a>
           
      
          <a class="badge badge-tag" href="/tags/macos">macos</a>
           
      
          <a class="badge badge-tag" href="/tags/tvos">tvos</a>
           
      
          <a class="badge badge-tag" href="/tags/watchos">watchos</a>
           
      
          <a class="badge badge-tag" href="/tags/nsformatter">nsformatter</a>
          
      
    
    
    <br/>
    <i class="fas fa-clock"></i> 7 min read
</div>


  </header>
  
  
  <div class="post">
    <p>Very often, we need to deal with data in a &ldquo;raw&rdquo; format that, if displayed directly to the user, it makes little sense to them. This kind of data includes a date timestamp, the number of bytes in a big file, or numbers with no rounding a bunch of decimals. There is a lot of data like this, and we need to be able to format it and show it to the user.</p>
<p>In all my years as a programmer, I have seen a lot of &ldquo;hacky ways&rdquo; to retrieve and parse content such as dates and file sizes. Sometimes, they were good, but more often than not they were extremely verbose code and unnecessary. NSFormatter has a lot of advantages, including providing localized representations where relevant.</p>
<h1 id="introducing-nsformatter">Introducing NSFormatter</h1>
<p>NSFormatter is considered an abstract class. You should never use it directly, but you can subclass it or use the specializations already provided by Foundation. This class helps create textual representation of values, and it can else help you validate and interpret such values.</p>
<p>In this article, we will explore a few existing <code>NSFormatter</code>s and when you may want to use them.</p>
<h1 id="existing-formatters">Existing Formatters</h1>
<p>There&rsquo;s a bunch of formatters that are already provided by Foundation. These include:</p>
<ul>
<li><a href="https://developer.apple.com/documentation/foundation/bytecountformatter">ByteCountFormatter</a>: To represent digital filesizes of data.</li>
<li><a href="https://developer.apple.com/documentation/foundation/dateformatter">DateFormatter</a>: For formatting dates.</li>
<li><a href="https://developer.apple.com/documentation/foundation/datecomponentsformatter">DateComponentsFormatter</a>: For formatting individual components, like &ldquo;2 days&rdquo;.</li>
<li><a href="https://developer.apple.com/documentation/foundation/dateintervalformatter">DateIntervalFormatter</a>: For formatting time ranges.</li>
<li><a href="https://developer.apple.com/documentation/foundation/energyformatter">EnergyFormatter</a>: You can use this to format energy values, from joules and kilojoules, to calories and kilocalories.</li>
<li><a href="https://developer.apple.com/documentation/foundation/lengthformatter">LengthFormatter</a>: Provides localized descriptions for distance and height units.</li>
<li><a href="https://developer.apple.com/documentation/foundation/massformatter">MassFormatter</a>: Provides formatting for mass and weight values.</li>
<li><a href="https://developer.apple.com/documentation/foundation/numberformatter">NumberFormatter</a>: For formatting numbers and their textual values.</li>
<li><a href="https://developer.apple.com/documentation/foundation/personnamecomponentsformatter">PersonNameComponentsFormatter</a>: Provides localized descriptions for the components in a person&rsquo;s name.</li>
<li><a href="https://developer.apple.com/documentation/foundation/iso8601dateformatter">ISO8601DateFormatter</a>: Introduced in iOS10, this handy formatter allows you to quickly work with dates returned in ISO8601 format. Handy for those web services that don&rsquo;t return timestamps.</li>
</ul>
<p>These are just some of the formatters that Cocoa already provides for you, but there&rsquo;s more. In this article we will not explore all of them. We will see the ones that you are very likely to need at some point.</p>
<h2 id="bytecountformatter">ByteCountFormatter</h2>
<p>This formatter allows you to represent file sizes in bytes in strings with their respective units. In other words, it allows you to display <code>1_000_000_000</code> bytes as <code>1GB</code>.</p>
<p>The basic usage looks like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#66d9ef">let</span> byteFormatter = ByteCountFormatter()
byteFormatter.countStyle = .decimal
byteFormatter.includesUnit = <span style="color:#66d9ef">true</span>
byteFormatter.allowedUnits = [.useGB]
<span style="color:#66d9ef">let</span> text = byteFormatter.string(fromByteCount: <span style="color:#ae81ff">1_000_000_000</span>)
</code></pre></div><p>A bit of discussion is in order.</p>
<p>First, as you may know, one gigabyte is not equivalent to 1,000,000,000 bytes. It&rsquo;s actually 1,073,741,824 bytes. As a convenience, we tend to just round to the nearest number when we talk about computer data file sizes, and even storage media manufactures of media do the same.</p>
<p>If you need the formatter to be precise and not consider <code>1,000,000,000</code> bytes as 1 gigabyte, you can change the <code>countStyle</code> property to use <code>.binary</code> instead of <code>.decimal</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift">byteFormatter.countStyle = .binary
<span style="color:#75715e">//...</span>
<span style="color:#66d9ef">let</span> text = byteFormatter.string(fromByteCount: <span style="color:#ae81ff">1_000_000_000</span>) <span style="color:#75715e">// This will now print 0.93GB</span>
</code></pre></div><p>Now the formatter is using the right byte count with no estimations to do all its formatting. If you format the value <code>1_073_741_824</code> with the new configuration, you will get <code>1GB</code>, which is expected.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift">byteFormatter.countStyle = .binary
<span style="color:#75715e">//...</span>
<span style="color:#66d9ef">let</span> text = byteFormatter.string(fromByteCount: <span style="color:#ae81ff">1_073_741_824</span>) <span style="color:#75715e">// 1GB</span>
</code></pre></div><p>Going back to the previous example, the one where the formatter prints <code>0.93GB</code>, you can configure this. It may not make sense to show a value like this for content that is less than one gigabyte, so how can we fix it? Using the <code>allowedUnits</code> property, you can specify all the units the formatter should use for formatting. Because we only have <code>.useGB</code> on it right now, it will only use gigabytes, no matter how big or small the value is.</p>
<p>You can specify as many units as you want here, and the formatter will know what unit to format the data with.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift">byteFormatter.countStyle = .binary
byteFormatter.includesUnit = <span style="color:#66d9ef">true</span>
byteFormatter.allowedUnits = [.useGB, .useMB]
<span style="color:#66d9ef">let</span> text = byteFormatter.string(fromByteCount: <span style="color:#ae81ff">1_000_000_000</span>) <span style="color:#75715e">// 953.7MB</span>
</code></pre></div><p>We are now telling the formatter to use GB and MB, and it will automatically format it depending on the size. Because <code>1_000_000_000</code> bytes make up less of a gigabyte when using the <code>.binary</code> count style, the formatter knows to format it as megabytes instead of gigabytes.</p>
<p>This formatter is really powerful and very easy to use. Feel free to play around with its properties. You can prevent it from showing the unit by setting <code>includesUnits</code> to <code>false</code>. You can choose to show the bytes value along with the formatted value with the <code>includesActualByteCount</code> property. In general, there&rsquo;s a lot you can do, but covering everything will create a very long article!</p>
<h2 id="dateformatter">DateFormatter</h2>
<p>You will very often want to format dates to be displayed to the user. DateFormatter gives us the power to format any date and output it in absolutely any format we want.</p>
<p>The basic usage looks like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#66d9ef">let</span> dateFormatter = DateFormatter()
dateFormatter.dateFormat = <span style="color:#e6db74">&#34;EEEE, MMM d, yyyy&#34;</span>
dateFormatter.timeZone = TimeZone(identifier: <span style="color:#e6db74">&#34;America/La_Paz&#34;</span>)<span style="color:#f92672">!</span>
<span style="color:#66d9ef">let</span> formattedDate = dateFormatter.string(from: now) <span style="color:#75715e">// Saturday, Sep 21, 2019</span>
</code></pre></div><p>The <code>dateFormat</code> property takes a string in the format you want. Memorizing this format is insane, so luckily there&rsquo;s resources out there that list each placeholder and how to use them, such as <a href="https://www.nsdateformatter.com">nsdateformatter.com</a>.</p>
<p>You can specify the <code>timeZone</code> the dates will be formatted for.</p>
<p>Once again, this is a very powerful and easy to use formatter, but it has a lot of options, even more than <code>ByteCountFormatter</code>. Explore the other properties so that you can build the formatter that you need. You will probably end up using the <code>locale</code> property often.</p>
<h2 id="datecomponentformatter">DateComponentFormatter</h2>
<p>This formatter formats quantities of time. You can use it to display how much time has passed since a given date. You can use it to format the amount of time between two <code>Date</code> objects.</p>
<p>Basic usage looks like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#66d9ef">let</span> dateComponentsFormatter = DateComponentsFormatter()
dateComponentsFormatter.allowedUnits = [.hour, .minute]
dateComponentsFormatter.unitsStyle = .brief
dateComponentsFormatter.string(from: oldDate, to: now) <span style="color:#75715e">// 3hr 29min</span>
</code></pre></div><p>This is yet again another flexible and powerful formatter. You can configure the allowed units, the style, and much more. Many modern social networks show you the relative time of new content until a certain amount of time has passed, and this formatter allows you to do the same.</p>
<h1 id="a-word-on-performance">A Word On Performance</h1>
<p>Creating Formatters is a very expensive operation, and you may want to use them in situations when you will undoubtedly create many of them. If you are writing a calendar application, you may want to use <code>DateFormatter</code> to neatly display the time of events in a <code>UITableView</code>. The problem with this is that your first attempt at implementing this will likely create a new formatter every time a new cell is queued.</p>
<p>If possible, create a singleton or store your existing formatters somewhere.</p>
<p>In an app I have worked on, I had various different date formatters for various different contexts, so I had to create many of them. I also had to display them in table views. To get as much performance as possible, I created a singleton called <code>DateFormatters</code> that stores a <code>[String: DateFormatter]</code> dictionary, and it exposes the formatters through a subscript. The subscript takes the format you want to format a date in, and it returns a formatter for it. If a format for that format already exists, it returns it, otherwise, it creates a new one. It looked like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DateFormatters</span> {
    <span style="color:#66d9ef">var</span> formatters = [String: DateFormatter]()
    
    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">let</span> shared = DateFormatters()
    
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">init</span>() {}
    
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">subscript</span>(dateFormat: String) -&gt; DateFormatter {
        <span style="color:#66d9ef">if</span> <span style="color:#66d9ef">let</span> formatter = formatters[dateFormat] {
            <span style="color:#66d9ef">return</span> formatter
        }
        
        <span style="color:#66d9ef">let</span> newFormatter = DateFormatter()
        newFormatter.timeZone = TimeZone(identifier: <span style="color:#e6db74">&#34;America/La_Paz&#34;</span>)<span style="color:#f92672">!</span>
        newFormatter.dateFormat = dateFormat
        formatters[dateFormat] = newFormatter
        <span style="color:#66d9ef">return</span> newFormatter
    }
}
</code></pre></div><p>The app was for my country only, so I could use the same <code>TimeZone</code> for all formatters, and whenever I needed a new formatter, I used it like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#66d9ef">let</span> dateAndHour = DateFormatters.shared[<span style="color:#e6db74">&#34;EEEE, MMM d, yyyy HH:mm:ss&#34;</span>]
<span style="color:#66d9ef">let</span> dateAndHourString = dateAndHour.string(from: now) <span style="color:#75715e">// Saturday, Sep 21, 2019 17:11:09</span>

<span style="color:#66d9ef">let</span> justDate = DateFormatters.shared[<span style="color:#e6db74">&#34;EEEE, MMM d, yyyy&#34;</span>]
<span style="color:#66d9ef">let</span> justDateString = justDate.string(from: now) <span style="color:#75715e">// Saturday, Sep 21, 2019</span>

<span style="color:#66d9ef">let</span> justHour = DateFormatters.shared[<span style="color:#e6db74">&#34;HH:mm:ss&#34;</span>]
<span style="color:#66d9ef">let</span> justHourString = justHour.string(from: now) <span style="color:#75715e">// 17:11:09</span>

<span style="color:#66d9ef">let</span> justHourComponent = DateFormatters.shared[<span style="color:#e6db74">&#34;HH&#34;</span>]
<span style="color:#66d9ef">let</span> justHourComponentString = justHourComponent.string(from: now) <span style="color:#75715e">// 17</span>
</code></pre></div><p>If at some point I needed a formatter with a format it had already used, it would retrieve it from the dictionary rather than creating a new one.</p>
<h1 id="conclusion">Conclusion</h1>
<p><code>NSFormatter</code> provides many powerful subclasses for formatting data into human-readable form. There&rsquo;s many of them provided by the framework, and you can create your own subclasses if you need to.</p>
<p>They have performance implications though, so you should use them carefully, specially if used in table views or other reusable components.</p>

  </div>
  

<div class="navigation navigation-single">
    
    <a href="/posts/ipad-multiwindow-support/" class="navigation-prev">
      <i aria-hidden="true" class="fa fa-chevron-left"></i>
      <span class="navigation-tittle">Understanding the Essentials for Adopting Multiwindow Support on iPadOS</span>
    </a>
    
    
    <a href="/posts/playing-custom-haptics-on-ios/" class="navigation-next">
      <span class="navigation-tittle">Playing Custom Haptics on iOS</span>
      <i aria-hidden="true" class="fa fa-chevron-right"></i>
    </a>
    
</div>


  

  
    
        <script src="https://utteranc.es/client.js"
        repo="AndyIbanez/andyibanez-com"
        issue-term="pathname"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
    


</article>


        </div>
        
    

  
  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-146179797-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


<script defer src="https://use.fontawesome.com/releases/v5.5.0/js/all.js" integrity="sha384-GqVMZRt5Gn7tB9D9q7ONtcp4gtHIUEW/yG7h98J7IpE3kpi+srfFyyB/04OV6pG0" crossorigin="anonymous"></script>


    
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
        
            
                <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/languages/swift.min.js"></script>
            
                <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/languages/objectivec.min.js"></script>
            
        
    
    <script type="text/javascript">
        
        hljs.configure({languages: ["swift, objectivec"]});
        
        hljs.initHighlightingOnLoad();
    </script>
    




    



    </body>
</html>
